<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form action="#" name="formulario" th:action="@{/coches/addcochespost}" th:objetct="${coche}" method="post">
    <p>nbastidor: <input type="text" th:field="${coche.nbastidor}"/> </p>
    <select th:field="${coche.marca}" name="marca" onchange="select2()">
        <option id="marca" th:each="i : ${marcas}" th:value="${i.id}" th:text="${i.marca}"></option>
    </select>
    <select th:field="${coche.modelo}">
        <option id="modelo" value=""></option>
    </select>
    <p>kilometros: <input type="number" th:field="${coche.kilometros}"/> </p>
    <p>motor: <input type="text" th:field="${coche.motor}"/> </p>
    <p>modificaciones: <input type="number" th:field="${coche.modificaciones}"/> </p>
    <p>tipo_modificaciones: <input type="text" th:field="${coche.tipo_modificaciones}"/> </p>
    <p><input type="submit" value="SUBMIT"/> </p>
</form>
</body>
<script th:inline="javascript">
    const marca = document.getElementById('marca');
    var modelos = [[${modelos}]];
    var nuevos_modelos = [];
    function select2(){
        var marca = document.formulario.marca[document.formulario.marca.selectedIndex].value
        console.log(marca)
        if(marca != 0){
            console.log(Object.values(modelos[1])[2])
            for (let i = 0; i < modelos.length; i++) {

                if (Object.values(modelos[i])[2] === marca.value){
                    console.log(modelos[i])
                    // nuevos_modelos.push(modelos[i])
                }
            }
        }
        console.log(nuevos_modelos)
    }

</script>
</html>